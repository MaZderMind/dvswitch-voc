#!/usr/bin/make -f

build :
	make prefix=/usr

install-stamp : build
	dh_testroot
	make DESTDIR=$$(pwd)/debian/tmp prefix=/usr install
	mkdir -p debian/dvsink/usr/bin debian/dvsink/usr/share/doc
	mv debian/tmp/usr/bin/dvsink-file debian/dvsink/usr/bin
	mv debian/tmp/usr/bin/dvsink-firewire debian/dvsink/usr/bin
	cp -R debian/tmp/usr/share/doc/dvswitch \
		debian/dvsink/usr/share/doc/dvsink
	mkdir -p debian/dvsource/usr/bin debian/dvsource/usr/share/doc
	mv debian/tmp/usr/bin/dvsource-file debian/dvsource/usr/bin
	mv debian/tmp/usr/bin/dvsource-firewire debian/dvsource/usr/bin
	cp -R debian/tmp/usr/share/doc/dvswitch \
		debian/dvsource/usr/share/doc/dvsource
	mkdir -p debian/dvswitch/usr/bin debian/dvswitch/usr/share/doc
	mv debian/tmp/usr/bin/dvswitch debian/dvswitch/usr/bin
	mv debian/tmp/usr/share/doc/dvswitch \
		debian/dvswitch/usr/share/doc/dvswitch
	touch install-stamp

binary : binary-arch binary-indep

binary-arch : install-stamp
	dh_strip
	dh_shlibdeps
	dh_installchangelogs -a
	dh_installdocs -a
	dh_compress -a
	dh_fixperms -a
	dh_installdeb -a
	dh_gencontrol -a
	dh_builddeb -a

binary-indep : install-stamp
	dh_installchangelogs -i
	dh_installdocs -i
	dh_compress -i
	dh_fixperms -i
	dh_installdeb -i
	dh_gencontrol -i
	dh_builddeb -i	

clean :
	make clean
	dh_clean install-stamp

.PHONY : build binary binary-arch binary-indep clean
